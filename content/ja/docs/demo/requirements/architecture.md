---
title: アーキテクチャ要件
linkTitle: アーキテクチャ
aliases: [architecture_requirements]
cSpell:ignore: dockerstatsreceiver
default_lang_commit: 8a2cdaa4b5af00019b36d1d6667d58f82abf7a0a
---

## 概要 {#summary}

OpenTelemetry コミュニティデモアプリケーションは、本番環境に近いクラウドネイティブアプリケーションにおいて、OpenTelemetry API、SDK、およびツールを紹介することを目的としています。
このアプリケーションの全体的な目標は、OpenTelemetry コンポーネントの標準的な'デモ'を提供するだけでなく、エンドユーザー、ベンダー、およびその他のステークホルダーがさらにカスタマイズするためのフレームワークとしても機能することです。

### 要件 {#requirements}

- [アプリケーション要件](../application/)
- [OpenTelemetry 要件](../opentelemetry/)
- [システム要件](../system/)

### アプリケーション目標 {#application-goals}

- 開発者に OpenTelemetry 計装を学ぶ際に使用できる堅牢なサンプルアプリケーションを提供する。
- オブザーバビリティベンダーに、さらにカスタマイズ可能な（またはそのまま使える）単一かつ十分にサポートされたデモプラットフォームを提供する。
- OpenTelemetry コミュニティに、OTel API、SDK、ツールの機能と性能を実証する生きた成果物を提供する。
- OpenTelemetry のメンテナーやワーキンググループに、新機能/コンセプトを'実環境で'デモンストレーションするためのプラットフォームを提供する。

以下は、デモアプリケーションの論理コンポーネントの一般的な説明です。

## メインアプリケーション {#main-application}

デモアプリの大部分は、eコマースサイトのような、役に立つ '実世界' の作業を行う自己完結型のマイクロサービスベースのアプリケーションです。このアプリケーションは、gRPC と HTTP で相互に通信する複数のサービスで構成されており、Kubernetes（またはDocker、ローカル）上で動作します。

各サービスは、（該当かつ利用可能な場合に）トレース、メトリクス、ログについて OpenTelemetry で計装されなければならない。

各サービスは、同じビジネスロジックを実行し、同じ gRPC エンドポイントを実装しながらも、異なる言語/実装で書かれたサービスと交換可能であるべきです。

各サービスは、分散アプリケーションにおけるテレメトリがどのように問題解決に役立つかを示すために使用できる障害を有効化/無効化できるように、フィーチャーフラグサービスと通信できるべきである。

## フィーチャーフラグコンポーネント {#feature-flag-component}

フィーチャーフラグは、クラウドネイティブアプリケーション開発における重要な要素です。
デモでは、CNCF の Incubating Projects である OpenFeature を使用して、フィーチャーフラグを管理します。

フィーチャーフラグは、flagd configurator のユーザーインターフェースを通じて設定できます。

## オーケストレーションおよびデプロイメント {#orchestration-and-deployment}

すべてのサービスは Kubernetes 上で実行します。OpenTelemetry コレクターは OpenTelemetry Operator を用いてデプロイされるべきで、サイドカー + ゲートウェイモードで動作するべきです。各 Pod からのテレメトリはエージェントからゲートウェイへルーティングされるべきで、ゲートウェイはデフォルトでオープンソースのトレース + メトリクス可視化ツールへテレメトリをエクスポートするべきです。

ローカル環境や Kubernetes 以外の環境でのデプロイにおいて、コレクターは compose ファイルを用いてデプロイされるべきで、アプリケーションからのトレース/メトリクスだけでなく、`dockerstatsreceiver` 経由で Docker コンテナも監視するべきです。

本プロジェクトの設計目標の一つは、クラウド環境へ自己デプロイするための CI/CD パイプラインを含めることです。ローカル開発においては、このパイプラインは省略しても構いません。
